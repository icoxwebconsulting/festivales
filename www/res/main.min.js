var app=angular.module("festival",["ionic","ngCordova","ngCordovaOauth","spotify"]);app.run(function($rootScope,$state,$stateParams,$ionicPlatform){$ionicPlatform.ready(function(){window.cordova&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault()})}),app.config(function($stateProvider,$urlRouterProvider,$ionicConfigProvider){$stateProvider.state("base",{url:"/","abstract":!0,templateUrl:"templates/base.html",controller:"BaseController"}).state("base.login",{url:"login",views:{content:{templateUrl:"templates/user/login.html",controller:"LoginController"}}}).state("base.register",{url:"register",views:{content:{templateUrl:"templates/user/register.html",controller:"RegisterController"}}}).state("menu",{url:"app/","abstract":!0,templateUrl:"templates/menu.html",controller:"MenuController"}).state("menu.main",{url:"main",views:{content:{templateUrl:"templates/artist/main.html",controller:"MainController"}}}).state("menu.ticket",{url:"ticket",views:{content:{templateUrl:"templates/ticket.html",controller:"TicketController"}}}),$urlRouterProvider.otherwise("/login"),$ionicConfigProvider.views.maxCache(0)}),app.constant("GLOBAL",{HOST:"http://festivales.dev/app_dev.php/api/",IMAGE:"http://festivales.icox.mobi/",COUNTRY_ISO:"ES"}),app.controller("accountCtrl",function($scope,$state){$scope.state=$state}),app.controller("BaseController",function($scope,$state){$scope.state=$state,$scope.view={},$scope.view.navigation=!1}),app.controller("FavoriteController",function($scope){$scope.init=function(){$scope.view={}}}),app.controller("LoginController",function($scope,$state,$http,$ionicLoading,$ionicPopup,$cordovaOauth){$scope.init=function(){$scope.view={},$scope.data={},$scope.error=!1,$scope.view.loginEmail=!1},$scope.init(),$scope.loginFacebook=function(){$cordovaOauth.facebook("1671907443037216",["email"]).then(function(result){$ionicLoading.show({template:"Verificando ..."})})},$scope.loginGoogle=function(){$cordovaOauth.google("140186210091-bp9lgae3g52hvmro7gse1q2t20gba32v.apps.googleusercontent.com",["email"]).then(function(result){$ionicLoading.show({template:"Verificando ..."})})},$scope.toggleLoginEmail=function(){$scope.view.loginEmail=!$scope.view.loginEmail},$scope.login=function(){$scope.error=!1,$scope.data.email?$scope.data.password?$ionicLoading.show({template:"Verificando ..."}):$ionicPopup.alert({title:"Ingrese su Contraseña"}):$ionicPopup.alert({title:"Ingrese su E-mail"})}}),app.controller("MainController",function($scope,$timeout,playerService){$scope.init=function(){$scope.audio=new Audio,$scope.view={}},$scope.init(),self.chunk=function(arr,size){for(var newArr=[],i=0;i<arr.length;i+=size)newArr.push(arr.slice(i,i+size));return console.info("return",newArr),newArr},$scope.$on("top_tracks",function(evt,data){$scope.view.tracks=self.chunk(data,2)}),$scope.playTrack=function(track){$scope.audio.src=track.preview_url,$scope.audio.play()},$scope.play=function(){$scope.audio.src&&$scope.audio.play()},$scope.stop=function(){$scope.audio.src&&$scope.audio.pause()}}),app.controller("MenuController",function($scope,$ionicModal,$timeout){$scope.init=function(){$scope.view={},$scope.view.show_list="favorites",$scope.view.favorites=!1,$scope.view.notifications=!1,$scope.view.setting={},$scope.view.setting.notifications=!0},$scope.init(),$ionicModal.fromTemplateUrl("templates/user/settings.html",{scope:$scope}).then(function(modal){$scope.modal=modal}),$scope.openSettings=function(){$scope.modal.show()},$scope.closeSettings=function(){$scope.modal.hide()}}),app.controller("notificationController",function($scope){$scope.init=function(){$scope.view={}}}),app.controller("playerController",function($scope,$state,$ionicModal){$scope.state=$state,$scope.view={},$scope.stop=function(){$scope.audio.src&&$scope.audio.pause()},$scope.play=function(){$scope.audio.src&&$scope.audio.play()},$ionicModal.fromTemplateUrl("templates/player/main.html",{scope:$scope}).then(function(modal){$scope.modal=modal}),$scope.openPlayer=function(){$scope.modal.show()},$scope.closePlayer=function(){$scope.modal.hide()}}),app.controller("PlaylistsCtrl",function($scope){$scope.playlists=[{title:"Reggae",id:1},{title:"Chill",id:2},{title:"Dubstep",id:3},{title:"Indie",id:4},{title:"Rap",id:5},{title:"Cowbell",id:6}]}).controller("PlaylistCtrl",function($scope,$stateParams){}),app.controller("RegisterController",function($scope,$state,$ionicLoading,$ionicPopup){$scope.data={privacy_police:!1},$scope.error=!1,$scope.signUp=function(){$scope.error=!1,$scope.data.email?$scope.data.password?$scope.data.password!==$scope.data.repassword?$ionicPopup.alert({title:"Confirme su Contraseña"}):$ionicLoading.show({template:"Creando Cuenta ..."}):$ionicPopup.alert({title:"Ingrese su Contraseña"}):$ionicPopup.alert({title:"Ingrese su E-mail"})}}),app.controller("sidebarController",function($scope,$state){$scope.state=$state,$scope.view={},$scope.view.navigation=!1}),app.controller("TicketController",function($scope){$scope.init=function(){$scope.view={}}}),app.factory("playerService",function($rootScope,Spotify){var service={};return service.getTopTracks=function(spotifyId,countryIso){Spotify.getArtistTopTracks("4wLXwxDeWQ8mtUIRPxGiD6","ES").then(function(data){$rootScope.$broadcast("top_tracks",data.tracks)})},service.openSpotify=function(link){window.open(link,"_blank","location=yes")},service});